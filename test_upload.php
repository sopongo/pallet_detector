<?php
/**
 * Script р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Бр╕ер╕░р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Ир╕▓р╕Б URL
 * 
 * р╕гр╕╣р╕Ыр╕Хр╣Йр╕Щр╕Чр╕▓р╕З: https://adminlite.io/themes/v3/dist/img/user2-160x160.jpg
 * р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕Ыр╕ер╕▓р╕вр╕Чр╕▓р╕З: upload/line_image/pallet_detector/
 */

// тнР р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓
$sourceUrl = 'https://adminlte.io/themes/v3/dist/img/user2-160x160.jpg';
$uploadDir = '../upload/line_image/pallet_detector/';
$fileName = 'user2-160x160.jpg'; // р╕Кр╕╖р╣Ир╕нр╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╕Ир╕░р╕Ър╕▒р╕Щр╕Чр╕╢р╕Б (р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Др╕Фр╣Й)

// тнР р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕Цр╣Йр╕▓р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡
if (!is_dir($uploadDir)) {
    if (!mkdir($uploadDir, 0755, true)) {
        die("тЭМ Error: р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М {$uploadDir} р╣Др╕Фр╣Й");
    }
    echo "тЬЕ р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М {$uploadDir} р╕кр╕│р╣Ар╕гр╣Зр╕И<br>";
}

// тнР р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Ир╕▓р╕Б URL
echo "ЁЯФД р╕Бр╕│р╕ер╕▒р╕Зр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Ир╕▓р╕Б:  {$sourceUrl}<br>";

$imageData = @file_get_contents($sourceUrl);

// р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕кр╕│р╣Ар╕гр╣Зр╕Ир╕лр╕гр╕╖р╕нр╣Др╕бр╣И
if ($imageData === false) {
    die("тЭМ Error: р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Ир╕▓р╕Б URL р╣Др╕Фр╣Й<br>р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ URL р╕лр╕гр╕╖р╕н allow_url_fopen");
}

// тнР р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕ер╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М
$filePath = $uploadDir . $fileName;

if (file_put_contents($filePath, $imageData)) {
    $fileSize = filesize($filePath);
    $fileSizeKB = round($fileSize / 1024, 2);
    
    echo "тЬЕ р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕кр╕│р╣Ар╕гр╣Зр╕И! <br>";
    echo "ЁЯУБ р╣Др╕Яр╕ер╣М:  {$filePath}<br>";
    echo "ЁЯУК р╕Вр╕Щр╕▓р╕Ф: {$fileSizeKB} KB<br>";
    echo "ЁЯФЧ URL: <a href='{$filePath}' target='_blank'>{$filePath}</a><br>";
    
    // р╣Бр╕кр╕Фр╕Зр╕гр╕╣р╕Ыр╕ар╕▓р╕Ю
    echo "<br><img src='{$filePath}' alt='Uploaded Image' style='max-width: 300px; border: 2px solid #ccc; border-radius: 8px;'>";
} else {
    die("тЭМ Error: р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Др╕Яр╕ер╣Мр╣Др╕Фр╣Й<br>р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ permission р╕Вр╕нр╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М");
}
?>