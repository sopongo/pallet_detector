-- phpMyAdmin SQL Dump
-- version 5.2.0
-- https://www.phpmyadmin.net/
--
-- Host: localhost:3306
-- Generation Time: Jan 07, 2026 at 05:44 PM
-- Server version: 8.0.30
-- PHP Version: 8.1.10

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `db_pallet_detector`
--

-- --------------------------------------------------------

--
-- Table structure for table `tb_image`
--

CREATE TABLE `tb_image` (
  `id_img` int NOT NULL COMMENT 'ID รูปภาพ',
  `image_date` datetime NOT NULL COMMENT 'วันเวลาที่ถ่ายรูป',
  `image_name` varchar(80) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT 'ชื่อไฟล์รูป (เช่น IMG_20260107_150000.jpg)',
  `pallet_detected` int DEFAULT '0' COMMENT 'จำนวนพาเลท/person ที่ detect ได้ในรูปนี้',
  `site` int DEFAULT NULL COMMENT 'ไซต์/สาขา (เช่น 1=PCS, 2=PACT)',
  `location` int DEFAULT NULL COMMENT 'อาคาร/โซน (เช่น 1=Building 1)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ตารางเก็บประวัติการถ่ายภาพประจำรอบ';

--
-- Dumping data for table `tb_image`
--

INSERT INTO `tb_image` (`id_img`, `image_date`, `image_name`, `pallet_detected`, `site`, `location`) VALUES
(1, '2026-01-07 22:09:24', 'IMG_20260107_220921.jpg', 0, 1, 8),
(2, '2026-01-07 22:10:14', 'IMG_20260107_221012.jpg', 0, 1, 8),
(3, '2026-01-07 22:10:27', 'IMG_20260107_221026.jpg', 0, 1, 8),
(4, '2026-01-07 22:10:39', 'IMG_20260107_221038.jpg', 0, 1, 8),
(5, '2026-01-07 22:10:52', 'IMG_20260107_221051.jpg', 0, 1, 8),
(6, '2026-01-07 22:11:05', 'IMG_20260107_221104.jpg', 0, 1, 8),
(7, '2026-01-07 22:11:18', 'IMG_20260107_221117.jpg', 0, 1, 8),
(8, '2026-01-07 22:11:32', 'IMG_20260107_221131.jpg', 0, 1, 8),
(9, '2026-01-07 22:11:45', 'IMG_20260107_221144.jpg', 0, 1, 8),
(10, '2026-01-07 22:11:58', 'IMG_20260107_221156.jpg', 1, 1, 8),
(11, '2026-01-07 22:14:26', 'IMG_20260107_221423.jpg', 1, 1, 8),
(12, '2026-01-07 22:14:38', 'IMG_20260107_221437.jpg', 1, 1, 8),
(13, '2026-01-07 22:16:03', 'IMG_20260107_221601.jpg', 1, 1, 8),
(14, '2026-01-07 22:16:16', 'IMG_20260107_221615.jpg', 1, 1, 8),
(15, '2026-01-07 22:16:29', 'IMG_20260107_221628.jpg', 1, 1, 8),
(16, '2026-01-07 22:16:42', 'IMG_20260107_221641.jpg', 1, 1, 8),
(17, '2026-01-07 22:16:55', 'IMG_20260107_221654.jpg', 1, 1, 8),
(18, '2026-01-07 22:17:08', 'IMG_20260107_221706.jpg', 1, 1, 8),
(19, '2026-01-07 22:17:20', 'IMG_20260107_221719.jpg', 0, 1, 8),
(20, '2026-01-07 22:17:34', 'IMG_20260107_221733.jpg', 1, 1, 8),
(21, '2026-01-07 22:17:47', 'IMG_20260107_221746.jpg', 1, 1, 8),
(22, '2026-01-07 22:18:00', 'IMG_20260107_221759.jpg', 1, 1, 8),
(23, '2026-01-07 22:18:13', 'IMG_20260107_221812.jpg', 1, 1, 8),
(24, '2026-01-07 22:18:26', 'IMG_20260107_221825.jpg', 1, 1, 8),
(25, '2026-01-07 22:18:39', 'IMG_20260107_221838.jpg', 1, 1, 8),
(26, '2026-01-07 22:18:52', 'IMG_20260107_221851.jpg', 1, 1, 8),
(27, '2026-01-07 22:19:05', 'IMG_20260107_221904.jpg', 0, 1, 8),
(28, '2026-01-07 22:19:18', 'IMG_20260107_221917.jpg', 0, 1, 8),
(29, '2026-01-07 22:19:31', 'IMG_20260107_221930.jpg', 1, 1, 8),
(30, '2026-01-07 22:19:44', 'IMG_20260107_221943.jpg', 1, 1, 8),
(31, '2026-01-07 22:19:57', 'IMG_20260107_221956.jpg', 1, 1, 8),
(32, '2026-01-07 22:21:37', 'IMG_20260107_222135.jpg', 0, 1, 8),
(33, '2026-01-07 22:21:50', 'IMG_20260107_222149.jpg', 1, 1, 8),
(34, '2026-01-07 22:22:03', 'IMG_20260107_222202.jpg', 0, 1, 8),
(35, '2026-01-07 22:22:16', 'IMG_20260107_222215.jpg', 1, 1, 8),
(36, '2026-01-07 22:22:29', 'IMG_20260107_222228.jpg', 1, 1, 8),
(37, '2026-01-07 22:22:42', 'IMG_20260107_222241.jpg', 1, 1, 8),
(38, '2026-01-07 22:47:23', 'IMG_20260107_224721.jpg', 0, 1, 8),
(39, '2026-01-07 22:47:36', 'IMG_20260107_224735.jpg', 0, 1, 8),
(40, '2026-01-07 22:47:49', 'IMG_20260107_224748.jpg', 1, 1, 8),
(41, '2026-01-07 22:48:02', 'IMG_20260107_224800.jpg', 1, 1, 8),
(42, '2026-01-07 22:48:14', 'IMG_20260107_224813.jpg', 1, 1, 8),
(43, '2026-01-07 22:48:27', 'IMG_20260107_224826.jpg', 1, 1, 8),
(44, '2026-01-07 22:48:40', 'IMG_20260107_224839.jpg', 0, 1, 8),
(45, '2026-01-07 22:48:53', 'IMG_20260107_224852.jpg', 0, 1, 8),
(46, '2026-01-07 22:49:07', 'IMG_20260107_224906.jpg', 0, 1, 8),
(47, '2026-01-07 22:59:50', 'IMG_20260107_225948.jpg', 0, 1, 8),
(48, '2026-01-07 23:00:03', 'IMG_20260107_230002.jpg', 0, 1, 8),
(49, '2026-01-07 23:00:16', 'IMG_20260107_230015.jpg', 0, 1, 8),
(50, '2026-01-07 23:00:29', 'IMG_20260107_230028.jpg', 0, 1, 8),
(51, '2026-01-07 23:00:42', 'IMG_20260107_230040.jpg', 0, 1, 8),
(52, '2026-01-07 23:00:55', 'IMG_20260107_230054.jpg', 0, 1, 8),
(53, '2026-01-07 23:01:08', 'IMG_20260107_230107.jpg', 0, 1, 8),
(54, '2026-01-07 23:01:21', 'IMG_20260107_230120.jpg', 0, 1, 8),
(55, '2026-01-07 23:01:34', 'IMG_20260107_230133.jpg', 0, 1, 8),
(56, '2026-01-07 23:01:47', 'IMG_20260107_230146.jpg', 0, 1, 8),
(57, '2026-01-07 23:02:00', 'IMG_20260107_230159.jpg', 0, 1, 8),
(58, '2026-01-07 23:02:13', 'IMG_20260107_230212.jpg', 0, 1, 8),
(59, '2026-01-07 23:02:26', 'IMG_20260107_230224.jpg', 0, 1, 8),
(60, '2026-01-07 23:02:38', 'IMG_20260107_230237.jpg', 0, 1, 8),
(61, '2026-01-07 23:02:51', 'IMG_20260107_230250.jpg', 1, 1, 8),
(62, '2026-01-07 23:03:04', 'IMG_20260107_230303.jpg', 1, 1, 8),
(63, '2026-01-07 23:03:18', 'IMG_20260107_230317.jpg', 0, 1, 8),
(64, '2026-01-07 23:03:31', 'IMG_20260107_230330.jpg', 1, 1, 8),
(65, '2026-01-07 23:03:44', 'IMG_20260107_230343.jpg', 1, 1, 8),
(66, '2026-01-07 23:03:58', 'IMG_20260107_230357.jpg', 0, 1, 8),
(67, '2026-01-07 23:04:11', 'IMG_20260107_230410.jpg', 1, 1, 8),
(68, '2026-01-07 23:04:24', 'IMG_20260107_230423.jpg', 1, 1, 8),
(69, '2026-01-07 23:04:37', 'IMG_20260107_230436.jpg', 0, 1, 8),
(70, '2026-01-07 23:04:50', 'IMG_20260107_230448.jpg', 1, 1, 8),
(71, '2026-01-07 23:22:30', 'IMG_20260107_232228.jpg', 0, 1, 8),
(72, '2026-01-07 23:22:43', 'IMG_20260107_232242.jpg', 1, 1, 8),
(73, '2026-01-07 23:22:56', 'IMG_20260107_232255.jpg', 1, 1, 8),
(74, '2026-01-07 23:23:09', 'IMG_20260107_232308.jpg', 1, 1, 8),
(75, '2026-01-07 23:23:22', 'IMG_20260107_232321.jpg', 1, 1, 8),
(76, '2026-01-07 23:23:35', 'IMG_20260107_232334.jpg', 1, 1, 8),
(77, '2026-01-07 23:23:48', 'IMG_20260107_232347.jpg', 0, 1, 8),
(78, '2026-01-07 23:24:01', 'IMG_20260107_232400.jpg', 0, 1, 8),
(79, '2026-01-07 23:24:13', 'IMG_20260107_232412.jpg', 1, 1, 8),
(80, '2026-01-07 23:24:26', 'IMG_20260107_232425.jpg', 0, 1, 8),
(81, '2026-01-07 23:24:39', 'IMG_20260107_232438.jpg', 0, 1, 8),
(82, '2026-01-07 23:24:52', 'IMG_20260107_232451.jpg', 1, 1, 8),
(83, '2026-01-07 23:25:05', 'IMG_20260107_232504.jpg', 1, 1, 8),
(84, '2026-01-07 23:25:18', 'IMG_20260107_232517.jpg', 1, 1, 8),
(85, '2026-01-07 23:34:06', 'IMG_20260107_233403.jpg', 0, 1, 8),
(86, '2026-01-07 23:34:19', 'IMG_20260107_233418.jpg', 1, 1, 8),
(87, '2026-01-07 23:34:32', 'IMG_20260107_233430.jpg', 1, 1, 8),
(88, '2026-01-07 23:34:45', 'IMG_20260107_233443.jpg', 1, 1, 8),
(89, '2026-01-07 23:36:26', 'IMG_20260107_233624.jpg', 0, 1, 8),
(90, '2026-01-07 23:36:39', 'IMG_20260107_233638.jpg', 1, 1, 8),
(91, '2026-01-07 23:36:52', 'IMG_20260107_233651.jpg', 0, 1, 8),
(92, '2026-01-07 23:37:05', 'IMG_20260107_233704.jpg', 1, 1, 8),
(93, '2026-01-07 23:37:18', 'IMG_20260107_233717.jpg', 1, 1, 8),
(94, '2026-01-07 23:37:31', 'IMG_20260107_233730.jpg', 1, 1, 8),
(95, '2026-01-07 23:37:44', 'IMG_20260107_233743.jpg', 0, 1, 8),
(96, '2026-01-07 23:45:53', 'IMG_20260107_234551.jpg', 0, 1, 8),
(97, '2026-01-07 23:46:06', 'IMG_20260107_234605.jpg', 0, 1, 8),
(98, '2026-01-07 23:46:19', 'IMG_20260107_234618.jpg', 0, 1, 8),
(99, '2026-01-07 23:46:32', 'IMG_20260107_234631.jpg', 0, 1, 8),
(100, '2026-01-07 23:46:46', 'IMG_20260107_234645.jpg', 0, 1, 8),
(101, '2026-01-07 23:46:59', 'IMG_20260107_234658.jpg', 0, 1, 8),
(102, '2026-01-07 23:47:12', 'IMG_20260107_234711.jpg', 0, 1, 8),
(103, '2026-01-07 23:47:25', 'IMG_20260107_234724.jpg', 0, 1, 8),
(104, '2026-01-07 23:47:38', 'IMG_20260107_234736.jpg', 0, 1, 8),
(105, '2026-01-07 23:47:50', 'IMG_20260107_234749.jpg', 1, 1, 8),
(106, '2026-01-07 23:48:03', 'IMG_20260107_234802.jpg', 1, 1, 8),
(107, '2026-01-07 23:48:16', 'IMG_20260107_234815.jpg', 1, 1, 8),
(108, '2026-01-08 00:18:03', 'IMG_20260108_001801.jpg', 0, 1, 8),
(109, '2026-01-08 00:18:16', 'IMG_20260108_001815.jpg', 0, 1, 8),
(110, '2026-01-08 00:18:29', 'IMG_20260108_001828.jpg', 0, 1, 8),
(111, '2026-01-08 00:18:42', 'IMG_20260108_001841.jpg', 0, 1, 8),
(112, '2026-01-08 00:18:56', 'IMG_20260108_001855.jpg', 0, 1, 8),
(113, '2026-01-08 00:19:09', 'IMG_20260108_001908.jpg', 0, 1, 8),
(114, '2026-01-08 00:19:22', 'IMG_20260108_001920.jpg', 0, 1, 8),
(115, '2026-01-08 00:19:34', 'IMG_20260108_001933.jpg', 0, 1, 8),
(116, '2026-01-08 00:19:47', 'IMG_20260108_001946.jpg', 0, 1, 8),
(117, '2026-01-08 00:20:00', 'IMG_20260108_001959.jpg', 0, 1, 8),
(118, '2026-01-08 00:20:13', 'IMG_20260108_002012.jpg', 0, 1, 8),
(119, '2026-01-08 00:20:26', 'IMG_20260108_002025.jpg', 0, 1, 8),
(120, '2026-01-08 00:20:39', 'IMG_20260108_002038.jpg', 0, 1, 8),
(121, '2026-01-08 00:20:52', 'IMG_20260108_002051.jpg', 0, 1, 8),
(122, '2026-01-08 00:21:05', 'IMG_20260108_002104.jpg', 0, 1, 8),
(123, '2026-01-08 00:21:18', 'IMG_20260108_002117.jpg', 0, 1, 8),
(124, '2026-01-08 00:21:31', 'IMG_20260108_002130.jpg', 0, 1, 8),
(125, '2026-01-08 00:21:44', 'IMG_20260108_002142.jpg', 0, 1, 8),
(126, '2026-01-08 00:21:57', 'IMG_20260108_002155.jpg', 1, 1, 8),
(127, '2026-01-08 00:22:09', 'IMG_20260108_002208.jpg', 1, 1, 8),
(128, '2026-01-08 00:22:22', 'IMG_20260108_002221.jpg', 1, 1, 8),
(129, '2026-01-08 00:22:35', 'IMG_20260108_002234.jpg', 1, 1, 8),
(130, '2026-01-08 00:22:48', 'IMG_20260108_002247.jpg', 0, 1, 8),
(131, '2026-01-08 00:23:01', 'IMG_20260108_002300.jpg', 1, 1, 8),
(132, '2026-01-08 00:23:14', 'IMG_20260108_002313.jpg', 1, 1, 8),
(133, '2026-01-08 00:23:27', 'IMG_20260108_002326.jpg', 1, 1, 8),
(134, '2026-01-08 00:23:40', 'IMG_20260108_002339.jpg', 0, 1, 8),
(135, '2026-01-08 00:23:53', 'IMG_20260108_002352.jpg', 0, 1, 8),
(136, '2026-01-08 00:24:07', 'IMG_20260108_002405.jpg', 0, 1, 8),
(137, '2026-01-08 00:24:19', 'IMG_20260108_002418.jpg', 0, 1, 8),
(138, '2026-01-08 00:25:39', 'IMG_20260108_002537.jpg', 0, 1, 8),
(139, '2026-01-08 00:25:52', 'IMG_20260108_002551.jpg', 0, 1, 8),
(140, '2026-01-08 00:26:04', 'IMG_20260108_002603.jpg', 0, 1, 8),
(141, '2026-01-08 00:26:17', 'IMG_20260108_002616.jpg', 0, 1, 8),
(142, '2026-01-08 00:26:30', 'IMG_20260108_002629.jpg', 0, 1, 8),
(143, '2026-01-08 00:26:43', 'IMG_20260108_002642.jpg', 0, 1, 8),
(144, '2026-01-08 00:26:56', 'IMG_20260108_002655.jpg', 1, 1, 8),
(145, '2026-01-08 00:27:09', 'IMG_20260108_002708.jpg', 0, 1, 8),
(146, '2026-01-08 00:27:22', 'IMG_20260108_002721.jpg', 0, 1, 8),
(147, '2026-01-08 00:27:35', 'IMG_20260108_002734.jpg', 0, 1, 8),
(148, '2026-01-08 00:27:48', 'IMG_20260108_002746.jpg', 0, 1, 8),
(149, '2026-01-08 00:28:00', 'IMG_20260108_002759.jpg', 0, 1, 8),
(150, '2026-01-08 00:28:13', 'IMG_20260108_002812.jpg', 0, 1, 8),
(151, '2026-01-08 00:28:26', 'IMG_20260108_002825.jpg', 0, 1, 8),
(152, '2026-01-08 00:28:39', 'IMG_20260108_002838.jpg', 0, 1, 8),
(153, '2026-01-08 00:29:32', 'IMG_20260108_002930.jpg', 1, 1, 8),
(154, '2026-01-08 00:29:45', 'IMG_20260108_002944.jpg', 1, 1, 8),
(155, '2026-01-08 00:29:59', 'IMG_20260108_002958.jpg', 1, 1, 8),
(156, '2026-01-08 00:30:12', 'IMG_20260108_003011.jpg', 1, 1, 8),
(157, '2026-01-08 00:30:26', 'IMG_20260108_003025.jpg', 1, 1, 8),
(158, '2026-01-08 00:30:40', 'IMG_20260108_003038.jpg', 0, 1, 8),
(159, '2026-01-08 00:30:52', 'IMG_20260108_003051.jpg', 0, 1, 8),
(160, '2026-01-08 00:31:05', 'IMG_20260108_003104.jpg', 0, 1, 8),
(161, '2026-01-08 00:31:18', 'IMG_20260108_003117.jpg', 1, 1, 8),
(162, '2026-01-08 00:31:31', 'IMG_20260108_003130.jpg', 0, 1, 8),
(163, '2026-01-08 00:31:44', 'IMG_20260108_003143.jpg', 1, 1, 8),
(164, '2026-01-08 00:31:57', 'IMG_20260108_003156.jpg', 0, 1, 8),
(165, '2026-01-08 00:32:10', 'IMG_20260108_003209.jpg', 1, 1, 8),
(166, '2026-01-08 00:32:23', 'IMG_20260108_003222.jpg', 1, 1, 8),
(167, '2026-01-08 00:32:36', 'IMG_20260108_003235.jpg', 1, 1, 8),
(168, '2026-01-08 00:32:49', 'IMG_20260108_003248.jpg', 1, 1, 8);

-- --------------------------------------------------------

--
-- Table structure for table `tb_notifications`
--

CREATE TABLE `tb_notifications` (
  `id_notification` int NOT NULL COMMENT 'ID การแจ้งเตือน',
  `ref_id_pallet` int NOT NULL COMMENT 'อ้างอิงไปยัง tb_pallet',
  `notify_type` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT 'LINE' COMMENT 'ประเภทการแจ้งเตือน (LINE, EMAIL, etc.)',
  `message` text COLLATE utf8mb4_unicode_ci COMMENT 'ข้อความที่ส่ง',
  `sent_at` datetime NOT NULL COMMENT 'เวลาที่ส่งการแจ้งเตือน',
  `success` tinyint(1) DEFAULT '0' COMMENT '0=ล้มเหลว, 1=สำเร็จ'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ตารางเก็บ log การแจ้งเตือน LINE/Email';

--
-- Dumping data for table `tb_notifications`
--

INSERT INTO `tb_notifications` (`id_notification`, `ref_id_pallet`, `notify_type`, `message`, `sent_at`, `success`) VALUES
(1, 21, 'LINE', 'Overtime alert: 0.2 min', '2026-01-08 00:29:46', 1),
(2, 21, 'LINE', 'Overtime alert: 0.4 min', '2026-01-08 00:29:59', 1),
(3, 21, 'LINE', 'Overtime alert: 0.7 min', '2026-01-08 00:30:12', 1),
(4, 21, 'LINE', 'Overtime alert: 0.9 min', '2026-01-08 00:30:27', 1),
(5, 25, 'LINE', 'Overtime alert: 0.2 min', '2026-01-08 00:32:36', 1),
(6, 25, 'LINE', 'Overtime alert: 0.4 min', '2026-01-08 00:32:50', 1);

-- --------------------------------------------------------

--
-- Table structure for table `tb_pallet`
--

CREATE TABLE `tb_pallet` (
  `id_pallet` int NOT NULL COMMENT 'ID พาเลท',
  `pallet_no` int DEFAULT NULL COMMENT 'เลขลำดับพาเลท (1, 2, 3.. .) รีเซ็ททุกวัน',
  `pallet_name` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT 'ชื่อพาเลท (เช่น PL-0001, PE-0002)',
  `ref_id_img` int NOT NULL COMMENT 'อ้างอิงไปยัง tb_image (รูปแรกที่เจอ)',
  `pos_x` decimal(10,2) DEFAULT NULL COMMENT 'ตำแหน่ง X ของจุดกึ่งกลาง (pixels)',
  `pos_y` decimal(10,2) DEFAULT NULL COMMENT 'ตำแหน่ง Y ของจุดกึ่งกลาง (pixels)',
  `pos_w` decimal(10,2) DEFAULT NULL COMMENT 'ความกว้างของกรอบ (pixels)',
  `pos_h` decimal(10,2) DEFAULT NULL COMMENT 'ความสูงของกรอบ (pixels)',
  `bbox_x1` decimal(10,2) DEFAULT NULL COMMENT 'มุมซ้ายบน X',
  `bbox_y1` decimal(10,2) DEFAULT NULL COMMENT 'มุมซ้ายบน Y',
  `bbox_x2` decimal(10,2) DEFAULT NULL COMMENT 'มุมขวาล่าง X',
  `bbox_y2` decimal(10,2) DEFAULT NULL COMMENT 'มุมขวาล่าง Y',
  `accuracy` decimal(5,2) DEFAULT NULL COMMENT 'ความแม่นยำของ detection (0.00-1.00)',
  `pallet_date_in` datetime DEFAULT NULL COMMENT 'วันเวลาที่เจอพาเลท (สำหรับ reset เลขทุกวัน)',
  `first_detected_at` datetime NOT NULL COMMENT 'เวลาที่เจอครั้งแรก',
  `last_detected_at` datetime NOT NULL COMMENT 'เวลาที่เจอครั้งล่าสุด',
  `is_active` tinyint(1) DEFAULT '1' COMMENT 'สถานะ active (1=ยังอยู่, 0=หายไปแล้ว)',
  `status` tinyint(1) DEFAULT '0' COMMENT '0=Normal, 1=Overtime, 2=Removed',
  `in_over` tinyint(1) DEFAULT '0' COMMENT '0=ยังไม่เกินเวลา, 1=เกินเวลาแล้ว',
  `over_time` datetime DEFAULT NULL COMMENT 'เวลาที่เริ่มเกิน threshold',
  `detector_count` int DEFAULT '1' COMMENT 'จำนวนครั้งที่ detect เจอ (update ทุกรอบ)',
  `notify_count` int DEFAULT '0' COMMENT 'จำนวนครั้งที่แจ้งเตือนแล้ว'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ตารางเก็บข้อมูลพาเลท/person ที่ตรวจจับได้';

--
-- Dumping data for table `tb_pallet`
--

INSERT INTO `tb_pallet` (`id_pallet`, `pallet_no`, `pallet_name`, `ref_id_img`, `pos_x`, `pos_y`, `pos_w`, `pos_h`, `bbox_x1`, `bbox_y1`, `bbox_x2`, `bbox_y2`, `accuracy`, `pallet_date_in`, `first_detected_at`, `last_detected_at`, `is_active`, `status`, `in_over`, `over_time`, `detector_count`, `notify_count`) VALUES
(1, 1, 'PL-0001', 10, '170.65', '192.95', NULL, NULL, '121.00', '150.00', '219.00', '235.00', '0.96', '2026-01-07 22:11:58', '2026-01-07 22:11:58', '2026-01-07 22:17:08', 0, 2, 1, '2026-01-07 22:16:03', 9, 0),
(2, 2, 'PL-0002', 20, '166.61', '216.43', NULL, NULL, '96.00', '139.00', '236.00', '293.00', '0.85', '2026-01-07 22:17:34', '2026-01-07 22:17:34', '2026-01-07 22:18:52', 0, 2, 1, '2026-01-07 22:17:47', 7, 0),
(3, 3, 'PL-0003', 29, '157.42', '210.23', NULL, NULL, '81.00', '122.00', '233.00', '298.00', '0.97', '2026-01-07 22:19:31', '2026-01-07 22:19:31', '2026-01-07 22:19:57', 0, 2, 1, '2026-01-07 22:19:44', 3, 0),
(4, 4, 'PL-0004', 33, '157.98', '211.31', NULL, NULL, '82.00', '124.00', '233.00', '298.00', '0.77', '2026-01-07 22:21:50', '2026-01-07 22:21:50', '2026-01-07 22:21:50', 0, 2, 0, NULL, 1, 0),
(5, 5, 'PL-0005', 35, '158.37', '210.04', NULL, NULL, '82.00', '121.00', '233.00', '298.00', '0.75', '2026-01-07 22:22:16', '2026-01-07 22:22:16', '2026-01-07 22:22:42', 0, 2, 1, '2026-01-07 22:22:29', 3, 0),
(6, 6, 'PL-0006', 40, '169.32', '209.96', NULL, NULL, '92.00', '122.00', '246.00', '297.00', '0.88', '2026-01-07 22:47:49', '2026-01-07 22:47:49', '2026-01-07 22:48:28', 0, 2, 1, '2026-01-07 22:48:02', 4, 0),
(7, 7, 'PL-0007', 61, '239.73', '202.12', NULL, NULL, '178.00', '135.00', '301.00', '269.00', '0.82', '2026-01-07 23:02:52', '2026-01-07 23:02:52', '2026-01-07 23:03:04', 0, 2, 0, NULL, 2, 0),
(8, 8, 'PL-0008', 64, '217.69', '191.86', NULL, NULL, '145.00', '114.00', '289.00', '269.00', '0.76', '2026-01-07 23:03:31', '2026-01-07 23:03:31', '2026-01-07 23:03:44', 0, 2, 0, NULL, 2, 0),
(9, 9, 'PL-0009', 67, '217.81', '191.00', NULL, NULL, '145.00', '112.00', '289.00', '269.00', '0.78', '2026-01-07 23:04:11', '2026-01-07 23:04:11', '2026-01-07 23:04:24', 0, 2, 0, NULL, 2, 0),
(10, 10, 'PL-0010', 70, '218.01', '190.08', NULL, NULL, '145.00', '110.00', '290.00', '269.00', '0.85', '2026-01-07 23:04:50', '2026-01-07 23:04:50', '2026-01-07 23:04:50', 0, 2, 0, NULL, 1, 0),
(11, 11, 'PL-0011', 72, '222.12', '190.23', NULL, NULL, '150.00', '110.00', '293.00', '269.00', '0.91', '2026-01-07 23:22:43', '2026-01-07 23:22:43', '2026-01-07 23:23:35', 0, 2, 0, NULL, 5, 0),
(12, 12, 'PL-0012', 79, '220.05', '194.23', NULL, NULL, '148.00', '112.00', '291.00', '275.00', '0.82', '2026-01-07 23:24:13', '2026-01-07 23:24:13', '2026-01-07 23:24:13', 0, 2, 0, NULL, 1, 0),
(13, 13, 'PL-0013', 82, '220.75', '193.47', NULL, NULL, '149.00', '113.00', '292.00', '273.00', '0.93', '2026-01-07 23:24:52', '2026-01-07 23:24:52', '2026-01-07 23:25:18', 0, 2, 0, NULL, 3, 0),
(14, 14, 'PL-0014', 86, '231.96', '202.26', NULL, NULL, '168.00', '131.00', '295.00', '272.00', '0.79', '2026-01-07 23:34:19', '2026-01-07 23:34:19', '2026-01-07 23:34:45', 0, 2, 0, NULL, 3, 0),
(15, 15, 'PL-0015', 90, '231.46', '201.68', NULL, NULL, '167.00', '130.00', '295.00', '273.00', '0.81', '2026-01-07 23:36:39', '2026-01-07 23:36:39', '2026-01-07 23:36:39', 0, 2, 0, NULL, 1, 0),
(16, 16, 'PL-0016', 92, '230.94', '182.01', NULL, NULL, '168.00', '114.00', '292.00', '249.00', '0.80', '2026-01-07 23:37:05', '2026-01-07 23:37:05', '2026-01-07 23:37:31', 0, 2, 0, NULL, 3, 0),
(17, 17, 'PL-0017', 105, '188.38', '201.25', NULL, NULL, '112.00', '118.00', '264.00', '283.00', '0.92', '2026-01-07 23:47:51', '2026-01-07 23:47:51', '2026-01-07 23:48:16', 0, 2, 0, NULL, 3, 0),
(18, 1, 'PL-0001', 126, '235.13', '202.80', NULL, NULL, '163.00', '120.00', '306.00', '285.00', '0.93', '2026-01-08 00:21:57', '2026-01-08 00:21:57', '2026-01-08 00:22:35', 0, 2, 0, NULL, 4, 0),
(19, 2, 'PL-0002', 131, '235.83', '201.52', NULL, NULL, '163.00', '118.00', '308.00', '284.00', '0.80', '2026-01-08 00:23:01', '2026-01-08 00:23:01', '2026-01-08 00:23:27', 0, 2, 0, NULL, 3, 0),
(20, 3, 'PL-0003', 144, '221.70', '227.22', NULL, NULL, '146.00', '140.00', '297.00', '313.00', '0.90', '2026-01-08 00:26:56', '2026-01-08 00:26:56', '2026-01-08 00:26:56', 0, 2, 0, NULL, 1, 0),
(21, 4, 'PL-0004', 153, '357.41', '76.78', NULL, NULL, '282.00', '0.00', '432.00', '153.00', '0.97', '2026-01-08 00:29:32', '2026-01-08 00:29:32', '2026-01-08 00:30:26', 0, 2, 1, '2026-01-08 00:29:45', 5, 4),
(22, 5, 'PL-0005', 161, '423.76', '187.26', NULL, NULL, '367.00', '158.00', '480.00', '215.00', '0.79', '2026-01-08 00:31:18', '2026-01-08 00:31:18', '2026-01-08 00:31:18', 0, 2, 0, NULL, 1, 0),
(23, 6, 'PL-0006', 163, '423.12', '186.93', NULL, NULL, '366.00', '157.00', '480.00', '216.00', '0.76', '2026-01-08 00:31:44', '2026-01-08 00:31:44', '2026-01-08 00:31:44', 0, 2, 0, NULL, 1, 0),
(24, 7, 'PL-0007', 165, '212.89', '163.95', NULL, NULL, '147.00', '111.00', '278.00', '216.00', '0.78', '2026-01-08 00:32:10', '2026-01-08 00:32:10', '2026-01-08 00:32:10', 0, 2, 0, NULL, 1, 0),
(25, 8, 'PL-0008', 166, '422.88', '187.08', NULL, NULL, '365.00', '158.00', '479.00', '216.00', '0.76', '2026-01-08 00:32:23', '2026-01-08 00:32:23', '2026-01-08 00:32:49', 1, 1, 1, '2026-01-08 00:32:36', 3, 2);

--
-- Indexes for dumped tables
--

--
-- Indexes for table `tb_image`
--
ALTER TABLE `tb_image`
  ADD PRIMARY KEY (`id_img`),
  ADD KEY `idx_image_date` (`image_date`),
  ADD KEY `idx_site_location` (`site`,`location`);

--
-- Indexes for table `tb_notifications`
--
ALTER TABLE `tb_notifications`
  ADD PRIMARY KEY (`id_notification`),
  ADD KEY `idx_ref_id_pallet` (`ref_id_pallet`),
  ADD KEY `idx_sent_at` (`sent_at`);

--
-- Indexes for table `tb_pallet`
--
ALTER TABLE `tb_pallet`
  ADD PRIMARY KEY (`id_pallet`),
  ADD KEY `idx_ref_id_img` (`ref_id_img`),
  ADD KEY `idx_pallet_date_in` (`pallet_date_in`),
  ADD KEY `idx_is_active` (`is_active`),
  ADD KEY `idx_status` (`status`),
  ADD KEY `idx_pallet_no` (`pallet_no`);

--
-- AUTO_INCREMENT for dumped tables
--

--
-- AUTO_INCREMENT for table `tb_image`
--
ALTER TABLE `tb_image`
  MODIFY `id_img` int NOT NULL AUTO_INCREMENT COMMENT 'ID รูปภาพ', AUTO_INCREMENT=169;

--
-- AUTO_INCREMENT for table `tb_notifications`
--
ALTER TABLE `tb_notifications`
  MODIFY `id_notification` int NOT NULL AUTO_INCREMENT COMMENT 'ID การแจ้งเตือน', AUTO_INCREMENT=7;

--
-- AUTO_INCREMENT for table `tb_pallet`
--
ALTER TABLE `tb_pallet`
  MODIFY `id_pallet` int NOT NULL AUTO_INCREMENT COMMENT 'ID พาเลท', AUTO_INCREMENT=26;

--
-- Constraints for dumped tables
--

--
-- Constraints for table `tb_notifications`
--
ALTER TABLE `tb_notifications`
  ADD CONSTRAINT `fk_notification_pallet` FOREIGN KEY (`ref_id_pallet`) REFERENCES `tb_pallet` (`id_pallet`) ON DELETE CASCADE;

--
-- Constraints for table `tb_pallet`
--
ALTER TABLE `tb_pallet`
  ADD CONSTRAINT `fk_pallet_image` FOREIGN KEY (`ref_id_img`) REFERENCES `tb_image` (`id_img`) ON DELETE CASCADE;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
